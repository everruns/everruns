# Internal Protocol (gRPC)
# Decision: gRPC for worker <-> control plane communication
# Decision: Uses tonic for gRPC
# Decision: Proto definitions mirror Rust types in core crate
#
# Proto regeneration: Types are auto-generated by tonic-build during `cargo build`.
# When you modify proto/worker.proto:
#   1. Edit the proto file
#   2. Run: cargo build -p everruns-internal-protocol
#   3. Rust types are regenerated automatically in target/debug/build/everruns-internal-protocol-*/out/
#   4. Update grpc_service.rs (control-plane) and grpc_adapters.rs (worker) to use new types

[package]
name = "everruns-internal-protocol"
version.workspace = true
edition.workspace = true
license.workspace = true
authors.workspace = true
description = "Internal gRPC protocol for Everruns worker-control plane communication"

[dependencies]
# gRPC
tonic = "0.12"
prost.workspace = true
prost-types.workspace = true

# Internal dependencies
everruns-core = { path = "../core" }

# Serialization (for JSON conversion)
serde.workspace = true
serde_json.workspace = true

# UUID and time
uuid.workspace = true
chrono.workspace = true

[build-dependencies]
tonic-build = "0.12"
