# Everruns Caddy Reverse Proxy Configuration
#
# Routes:
#   /api/*           -> API server (strips /api prefix)
#   /swagger-ui/*    -> API server (Swagger docs)
#   /api-doc/*       -> API server (OpenAPI spec)
#   /health          -> API server (health check)
#   /*               -> UI server (Next.js)

:8080 {
	# API routes - strip /api prefix
	handle_path /api/* {
		reverse_proxy api:9000
	}

	# Swagger UI - pass through to API
	handle /swagger-ui/* {
		reverse_proxy api:9000
	}

	# OpenAPI spec - pass through to API
	handle /api-doc/* {
		reverse_proxy api:9000
	}

	# Health check - pass through to API
	handle /health {
		reverse_proxy api:9000
	}

	# UI - everything else
	handle {
		reverse_proxy ui:9100
	}
}
